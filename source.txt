REPORT ZYGC_CLASSICAL_REPORTS1.
TABLES VBAK.
DATA : V1 TYPE VBAP-NETWR,
       V2 TYPE VBAP-NETWR.
*SELECTION REQUIREMENTS ACCORDING TO END-USER.
SELECTION-SCREEN BEGIN OF BLOCK A WITH FRAME TITLE TEXT-001.
SELECT-OPTIONS : S_VBELN FOR VBAK-VBELN,
                 S_AUDAT FOR VBAK-AUDAT.
PARAMETER S_KUNNR TYPE VBAK-KUNNR.
SELECTION-SCREEN END OF BLOCK A.
SELECTION-SCREEN BEGIN OF BLOCK C WITH FRAME TITLE TEXT-007.
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS VBE RADIOBUTTON GROUP B DEFAULT 'X'.
SELECTION-SCREEN COMMENT 3(8) TEXT-002.
PARAMETERS AUD RADIOBUTTON GROUP B.
SELECTION-SCREEN COMMENT 16(5) TEXT-003.
PARAMETERS KUN RADIOBUTTON GROUP B.
SELECTION-SCREEN COMMENT 25(8) TEXT-004.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK C.
SELECTION-SCREEN BEGIN OF BLOCK D WITH FRAME TITLE TEXT-008.
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS SUB AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 3(10) TEXT-005.
PARAMETERS GRA AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 17(10) TEXT-006.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK D.
*end of selection screen layout.
*providing default values to select-options
INITIALIZATION.
S_VBELN-LOW = '4000'.
S_VBELN-HIGH = '5000'.
S_VBELN-SIGN = 'I'.
S_VBELN-OPTION = 'BT'.
APPEND S_VBELN.
S_AUDAT-LOW = '01.01.1997'.
S_AUDAT-HIGH = '01.01.1997'.
S_AUDAT-SIGN = 'I'.
S_AUDAT-OPTION = 'BT'.
APPEND S_VBELN.
*valasating the select-options and display error message according to given inputs.
AT SELECTION-SCREEN.
PERFORM VALIDATION.
*selectiong required data on condition.
START-OF-SELECTION.
IF VBE = 'X'.
SELECT VBAK~VBELN,VBAK~AUDAT,VBAK~KUNNR,VBAK~BUKRS_VF,VBAP~POSNR,VBAP~MATNR,VBAP~KWMENG,VBAP~MEINS,VBAP~NETWR FROM VBAK INNER JOIN VBAP
ON VBAK~VBELN = VBAP~VBELN INTO TABLE @DATA(IT) WHERE VBAK~VBELN IN @S_VBELN.
ELSEIF AUD = 'X'.
SELECT VBAK~VBELN,VBAK~AUDAT,VBAK~KUNNR,VBAK~BUKRS_VF,VBAP~POSNR,VBAP~MATNR,VBAP~KWMENG,VBAP~MEINS,VBAP~NETWR FROM VBAK INNER JOIN VBAP
ON VBAK~VBELN = VBAP~VBELN INTO TABLE @IT WHERE VBAK~AUDAT IN @S_AUDAT.
ELSEIF KUN = 'X'.
SELECT VBAK~VBELN,VBAK~AUDAT,VBAK~KUNNR,VBAK~BUKRS_VF,VBAP~POSNR,VBAP~MATNR,VBAP~KWMENG,VBAP~MEINS,VBAP~NETWR FROM VBAK INNER JOIN VBAP
ON VBAK~VBELN = VBAP~VBELN INTO TABLE @IT WHERE VBAK~KUNNR = @S_KUNNR.
ENDIF.
*to display output according to requirement.
END-OF-SELECTION.
PERFORM DISPLAY.
*event in classical report top-of-page to show no of records present.
TOP-OF-PAGE.
PERFORM TOP.
FORM VALIDATION.
IF VBE = 'X'.
SELECT SINGLE VBELN FROM VBAK INTO @DATA(A1) WHERE VBELN IN @S_VBELN.
IF SY-SUBRC <> 0.
MESSAGE 'INVALID DETAILS' TYPE 'E'.
ENDIF.
ELSEIF AUD = 'X'.
SELECT SINGLE AUDAT FROM VBAK INTO @DATA(A2) WHERE AUDAT IN @S_AUDAT.
IF SY-SUBRC <> 0.
MESSAGE 'INVALID DETAILS' TYPE 'E'.
ENDIF.
ELSEIF KUN = 'X'.
SELECT SINGLE KUNNR FROM VBAK INTO @DATA(A3) WHERE KUNNR = @S_KUNNR.
IF SY-SUBRC <> 0.
MESSAGE 'INVALID DETAILS' TYPE 'E'.
ENDIF.
ENDIF.
ENDFORM.
FORM DISPLAY.
LOOP AT IT INTO DATA(WA).
AT FIRST.
PERFORM FIR.
ENDAT.
AT NEW VBELN.
ULINE.
WRITE 'SALES ORDER DOCUMENT NUMBER'.
WRITE WA-VBELN.
ENDAT.
WRITE :/ WA-AUDAT,WA-KUNNR,WA-BUKRS_VF,WA-POSNR,WA-MATNR,WA-KWMENG,WA-MEINS,WA-NETWR.
IF SUB = 'X'.
AT END OF VBELN.
SELECT VBELN,NETWR FROM VBAP INTO TABLE @DATA(IT1) WHERE VBELN = @WA-VBELN.
LOOP AT IT1 INTO DATA(WA1).
V1 = V1 + WA1-NETWR.
ENDLOOP.
WRITE / 'SUB-TOTAL:'.
WRITE (87)V1.
CLEAR V1.
ENDAT.
ENDIF.
IF GRA = 'X'.
AT LAST.
LOOP AT IT INTO WA.
V2 = V2 + WA-NETWR.
ENDLOOP.
ULINE.
WRITE / 'GRAND TOTAL:'.
WRITE (87)V2.
ENDAT.
ENDIF.
ENDLOOP.
ENDFORM.
FORM FIR.
IF VBE = 'X'.
WRITE 'SALES ORDER DETAILS FROM'.
WRITE S_VBELN-LOW.
WRITE 'TO'.
WRITE S_VBELN-HIGH.
ELSEIF AUD ='X'.
WRITE S_AUDAT-LOW.
WRITE 'TO'.
WRITE S_AUDAT-HIGH.
ELSEIF KUN = 'X'.
WRITE 'SALES ORDER OF CUSTOMER :'.
WRITE S_KUNNR.
ENDIF.
ENDFORM.
FORM TOP.
DESCRIBE TABLE IT LINES DATA(B1).
WRITE : 'NO OF RECORDS:', B1.
ENDFORM.